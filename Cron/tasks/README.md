# 计算任务定时执行
放置需要定时执行的函数代码，并编写脚本定时执行对应脚本

### 人物计算任务
1. 新用户加入历史计算任务
    1. 新用户加入计算状态为“未计算”，监测状态为“未在监测”
    2. 实时监测“未计算”用户，取出后调用计算函数进行计算
    3. 计算函数需要计算该用户过去15天的信息，以便展示各项图表
    4. 计算完成后将该用户计算状态改为“已完成”，监测状态改为“监测中”
2. 监测人物每日定时计算任务
    1. 每日取出库中计算状态为“已完成”，监测状态为“监测中”的用户
    2. 每次设置一批次数量的用户启动每日计算，计算数据仅为当天的数据，其中可能存在每日计算的依赖表
    3. 如果计算速度慢，可以将所有用户分成多批次多进程计算

### 事件计算任务
1. 事件添加时历史计算任务
    1. 当新事件添加时，根据其设置的关键词查找逻辑进行存储的流数据内微博的查找
    2. 将查找出的微博存储至es的一个索引当中，并将该事件加入事件库
    3. 调用事件计算函数对库中的微博进行计算
    4. 计算完成后将该事件计算状态改为“已完成”，监测状态改为“监测中”
2. 监测事件每日定时计算任务
    1. 每日取出库中计算状态为“已完成”，监测状态为“监测中”的事件
    2. 对于取出的事件，会重新利用关键词进行当天新微博的获取，并存储在索引中
    3. 对于事件新的微博，进行新一天结果的计算，或更新某些结果
3. 事件的重新计算
    1. 如果对事件的结果不满意，可以修改事件的关键词及阈值等，对事件进行重新计算
    2. 重新计算会建立新的数据索引，同时保留旧的数据索引
    3. 新的数据索引计算逻辑与新事件相同，计算完成后，用户可以在查看结果后，选择保留新的或旧的计算结果

### 信息计算任务
1. 信息添加时历史计算任务
    1. 信息的添加可以由系统自行判断，也可以由用户自行添加
    2. 实时监测“未计算”信息，取出后调用计算函数进行计算
    3. 新的信息添加时，会计算其过去15天的信息
    4. 计算完成后将该用户计算状态改为“已完成”，监测状态改为“监测中”
2. 监测信息每日定时计算任务
    1. 每日取出库中计算状态为“已完成”，监测状态为“监测中”的信息
    2. 每次设置一批次数量的信息启动每日计算，计算数据仅为当天的数据